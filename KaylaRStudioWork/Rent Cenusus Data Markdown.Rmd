---
title: "Housing Justice"
output: html_document
date: '2022-06-21'
---
```{r}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```

```{r}
# Reading in exported data to R markdown
library(readr)
CensusHousingData <- read_csv("CensusHousingData2020.csv")
CensusHousingData
```
```{r}
library(ggplot2) 
library(dplyr)
library(scales)
```

```{r}
#Median Data Values per County
CensusHousingData %>% 
  group_by(County) %>% 
  summarize(med_rent_est= median(MedRentE, na.rm=TRUE), med_rent_moe= median(MedRentM, na.rm=TRUE), med_tax_est=median(MedTaxE), med_tax_moe= median(MedRentM, na.rm=TRUE), MedRentTaxRatE=median(RentTaxRatE, na.rm=TRUE), MedRentTaxRatMOE=median(RentTaxRatMOE, na.rm=TRUE), MedRenterHHIncomee =median(MedRenterHHIncomeE, na.rm=TRUE), MedRenterHHIncomem=median(MedRenterHHIncomeM, na.rm=TRUE), MedRentPercHHIncomee=median(MedRentPercHHIncomeE, na.rm=TRUE), MedRenterPErcHHIncomem=median(MedRentPercHHIncomeM, na.rm=TRUE))
```


```{r}
MedianHousingData<-ACSData2020 %>% 
  group_by(County) %>% 
  summarize(med_rent_est= median(MedRentE, na.rm=TRUE), med_rent_moe= median(MedRentM, na.rm=TRUE), med_tax_est=median(MedTaxE), med_tax_moe= median(MedRentM, na.rm=TRUE), MedRentTaxRatE=median(RentTaxRatE, na.rm=TRUE), MedRentTaxRatMOE=median(RentTaxRatMOE, na.rm=TRUE))
```

```{r}
#Mean Data Values per County
CensusHousingData %>% 
  group_by(County) %>% 
  summarize(mean_rent_est= mean(MedRentE), mean_rent_moe= mean(MedRentM), mean_tax_est=mean(MedTaxE), mean_tax_moe= mean(MedRentM), MeanRentTaxRatE=mean(RentTaxRatE), MeanRentTaxRatMOE=mean(RentTaxRatMOE))
```
```{r}
ggplot(CensusHousingData) +
  aes(x = County, y = RentTaxRatE) +
  geom_boxplot()
```
```{r}
ggplot(MedianHousingData)+
  geom_bar(aes(x=County, y=med_rent_est), stat="identity", fill="skyblue", alpha=0.7)+
  geom_errorbar(aes(x=County, ymin=med_rent_est-med_rent_moe, ymax=med_rent_est+med_rent_moe), width=0.4, colour="orange", alpha=0.9, size=1.3)

```
```{r}
ggplot(MedianHousingData)+
  geom_bar(aes(x=County, y=med_tax_est), stat="identity", fill="skyblue", alpha=0.7)+
  geom_errorbar(aes(x=County, ymin=med_tax_est-med_tax_moe, ymax=med_tax_est+med_tax_moe), width=0.4, colour="orange", alpha=0.9, size=1.3)
```
```{r}
ggplot(MedianHousingData)+
  geom_bar(aes(x=County, y=MedRentTaxRatE), stat="identity", fill="skyblue", alpha=0.7)+
  geom_errorbar(aes(x=County, ymin=MedRentTaxRatE-MedRentTaxRatMOE, ymax=MedRentTaxRatE+MedRentTaxRatMOE), width=0.4, colour="orange", alpha=0.9, size=1.3)
```
```{r}
ggplot(CensusHousingData, aes(RentTaxRatE))+
  geom_histogram()+
  facet_wrap(~County)
```
```{r}
ggplot(CensusHousingData, aes(MedRentHHIncomeE))+
  geom_histogram()+
  facet_wrap(~County)
```
How does the total median gross rent relate to median renters income?
```{r}
ggplot(CensusHousingData) +
  aes(x = MedRenterHHIncomeE, y = MedRentE) +
  geom_point()
ggplotly()
```
```{r}
CensusHousingData %>% 
  ggplot()+
  geom_sf(aes(fill= RentTaxRatE))+
  geom_sf_label(aes(label = County), size=3, color ="black", fontface = "bold")+
  theme_void()
```
```{r}
ggplot(CensusHousingData)+
  aes(x=LotSize, y=TotalValue) +
  geom_point()+
  geom_smooth()+
  facet_wrap(~County)




```

```{r}
ggplot(CensusHousingData) +
  aes(x = MedRentBurdenPercE) +
  geom_bar()
```
```{r}
leaflet(CensusHousingData) %>% 
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(fillVolor)
```

```

