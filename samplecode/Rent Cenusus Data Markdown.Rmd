---
title: "Housing Justice"
output: 
  html_document:
    code_folding: "hide"
date: '2022-06-21'
---

```{r}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r}
# Reading in exported data to R markdown
library(tidyverse)
library(readr)
#CensusHousingData <- read_csv("2020CensusHousingData.csv")
CensusHousingData <- readRDS("cvl_rent.RDS")
CensusHousingData
```
```{r}
library(ggplot2) 
library(dplyr)
library(scales)
```

```{r}
#Median Data Values per County
cvl_rent3 <- CensusHousingData %>% 
  group_by(county) %>% 
  summarize(med_rent_est= median(medrentE, na.rm = TRUE), med_rent_moe= median(medrentM), med_tax_est=median(medtaxE), med_tax_moe= median(medtaxM), MedRentTaxRatE=median(rent_tax_ratio), MedRentTaxRatMOE=median(rent_tax_ratio_moe))
```
```{r}
#Mean Data Values per County
CensusHousingData %>% 
  group_by(county) %>% 
  summarize(mean_rent_est= mean(medrentE), mean_rent_moe= mean(medrentM), mean_tax_est=mean(medtaxE), mean_tax_moe= mean(medtaxM), MeanRentTaxRatE=mean(rent_tax_ratio), MeanRentTaxRatMOE=mean(rent_tax_ratio_moe))
```
```{r}
ggplot(CensusHousingData) +
  aes(x = county, y = rent_tax_ratio) +
  geom_boxplot()
```
```{r}
ggplot(cvl_rent3)+
  geom_bar(aes(x=county, y=med_rent_est), stat="identity", fill="skyblue", alpha=0.7)+
  geom_errorbar(aes(x=county, ymin=med_rent_est-med_rent_moe, ymax=med_rent_est+med_rent_moe), width=0.4, colour="orange", alpha=0.9, size=1.3)

```
```{r}
ggplot(cvl_rent3)+
  geom_bar(aes(x=county, y=med_tax_est), stat="identity", fill="skyblue", alpha=0.7)+
  geom_errorbar(aes(x=county, ymin=med_tax_est-med_tax_moe, ymax=med_tax_est+med_tax_moe), width=0.4, colour="orange", alpha=0.9, size=1.3)
```
```{r}
ggplot(cvl_rent3)+
  geom_bar(aes(x=county, y=MedRentTaxRatE), stat="identity", fill="skyblue", alpha=0.7)+
  geom_errorbar(aes(x=county, ymin=MedRentTaxRatE-MedRentTaxRatMOE, ymax=MedRentTaxRatE+MedRentTaxRatMOE), width=0.4, colour="orange", alpha=0.9, size=1.3)
```
```{r}
# ggplot(cvl_rent2, aes(RentTaxRatEst))+
#  geom_histogram()+
#  facet_wrap(~county)
```

